# AWS　core service 4

## 責任共有モデル
■ユーザー側の責任
- IAMによるアカウント管理/パスワードルールの設定
- セキュリティグループの設定など適切なネットワーク設定やトラフィック保護
- 構築したアプリケーションのセキュリティ対応
- ネットワーク/インスタンスオペレーションシステム(バッチ)などの設定
- OSやミドルウェアの脆弱性対応
- 通信トラフィックの暗号化/保有しているデータの暗号化

■責任共有モデルの統制範囲
- 継承される統制・・・ユーザー側が完全に継承する統制。物理統制(インフラなどの物理的な統制)と環境統制(network構成やtraffic制御などの環境設定)。
- 共有統制
    - パッチ管理・・・AWSがインフラの不具合に対するパッチ適用、ユーザーはゲストOSおよびアプリのパッチ適用責任。
    - 構成管理・・・AWSがインフラデバイスの構成を管理、ユーザーは独自のゲストOS、db、アプリの構成に責任。
    - 意識とトレーニング・・・AWSがAWS従業員のトレーニングを実施、ユーザーは自社は自社でトレーニングを実施。
- ユーザー固有の統制・・・AWSサービスにデプロイするアプリに基づいて、ユーザーがすべての責任を負う統制。

## IAM
- IAM(AWS Identity and Access Management)・・・安全にAWS操作を実施するための認証・認可の仕組み。  
- IAMポリシー・・・ユーザーなどへのアクセス権限を付与するための設定ドキュメント。  
- IAMロール・・・AWSリソースに権限を設定するIAM機能。    
- IAMユーザー・・・IAMポリシー内でAWSサービスを利用できるユーザー。基本操作はIAMユーザーで実施する。  
- IAMグループ・・・グループとして権限をまとめて設定された単位のこと。  

■アカウントの種類
- ルートアカウント・・・AWSアカウント作成時に作られるIDアカウント。すべてのAWSサービスとリソースを使用できる権限を有する。日常的なタスクは使用しないことを推奨。
- 管理者権限・・・管理者権限の許可が付与されたIAMユーザー。
- パワーユーザー・・・IAM以外のすべてのAWSサービスにフルアクセス権限を有するIAMユーザー。

■IAM権限のベストプラクティス
- AWSアカウントのルートユーザーへのアクセスキーをロックして通常はルートアカウントを使用しない。
- 個々のIAMユーザーを作成して、IAMユーザーで管理を行う。
- IAMユーザーへのアクセス許可を割り当てにIAMグループを利用する。
- IAMユーザーやIAMグループには最小権限のみを設定する。
- 新しくポリシーを作るのではなく、AWS管理ポリシーを使用する。
- インラインポリシーではなくカスタマー管理ポリシーを使用する。
- アクセスレベルを使用して、IAMアクセス許可を確認する。
- ユーザーのために強度の高いパスワードポリシーを設定する。
- MFAを有効化する。
- Amazon EC2インスタンスで実行するアプリケーションにはIAMロールを使用する。
- 第三者に一時的に認証を付与する場合はIAMロールを使用してアクセス許可を移譲する。
- アクセスキーを共有しない。
- 認証情報を定期的にローテーションする。
- 不要な認証情報の削除をする。
- AWSアカウントのアクティビティを監視する。

AWS Organizations・・・IAMのアクセス管理を大きな組織でも楽に実施できるようにするmanaged service。マスターアカウントがメンバーアカウントを管理。

## CloudTrailの概要

- Cloud tail・・・AWSユーザーの操作(APIコールやユーザーのサインインアクティビティ)をロギングするサービス。  
&nbsp;&nbsp;ユーザーアクセスとAPIコールの情報をS3バケットに保存し、CloudWatchで解析できる。

■CloudWatchの概要
- Cloud watch・・・AWSリソースとAWSで実行するアプリケーションのモニタリングサービスでさまざまなログやメトリクスを監視できる。
- CloudWatch アラーム・・・CloudWatchメトリクスに基づく数式の結果を監視するメトリクスアラームを作成。
- CloudWatch メトリクス・・・EC2などのAWSリソースの監視サービスであり、死活監視、性能監視、キャパシティ監視を実施する。
- CloudWatch Logs・・・CloudWatchと連携したログを収集、可視化するサービス。
    - ロググループ：ログを保存、管理するための設定を共有するグループ。複数のログストリームで構成。
    - ログストリーム：モニタリングしているリソースのタイムスタンプ順で表す。複数のログイベントで構成される。
    -　ログイベント；モニタリングしているリソースによって記録されたアクティビティレコード。イベント発生時のタイムスタンプとメッセージによって構成。
- CloudWatch Event・・・AWSリソースに対するイベントをトリガーにアクションを実行する。
- X-Rayトレース・・・アプリケーションが処理するリクエストに関するデータを収集するサービス。
- CloudWatch アプリケーションモニタリング・・・CloudWatch ServiceLensやRUMを利用して、アプリケーションのヘルスモニタリング。
    - CloudWatch ServiceLens：AWS X-Layと統合して、トレース、メトリクス、ログ、アラームおよび他のリソースヘルス情報を1箇所に統合して、サービスとアプリ監視。
    - CloudWatch RUM(RealTime User Monitoring)：アプリの信頼性、パフォーマンス、エンドユーザー満足度を可視化する。
- CloudWatch インサイト・・・Insightsを使用して、Lambda関数、Logs、Containerアプリなどのメトリクスとログを収集、集計、要約する。  
- メトリクス・・・監視対象から取得するデータポイントのセットのこと。  
- 名前空間・・・CloudWatchメトリクスのコンテナのこと。  異なる名前空間でメトリクスを分けることができる。  
- ディメンジョン・・・メトリクスを一位に識別する名前/値のペア